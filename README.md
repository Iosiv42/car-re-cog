# Car Re:Cog
Car Re:Cog это свёрточная нейросеть для распознавания автомобилей, основанная на Resnet18. Основной датасет содержит в себе набор из ~2400 автомобилей, разделенных на 9 классов.

# Установка
Выполните:
```sh
$ pip install .
```

# Использование
Используйте:
```sh
$ car-recog input_file model_path [-np normalize_params_json]
```

# Обучение
Распакуйте датасет в удобную вам директорию, откройте `src/car_recog/main.ipynb` и редактируйте константы под ваши нужды. Например, измните корневую директорию датасета, размер батча и т.д. Для удобства можете поместить папку с датасетом в корневую директорию репозитория и оставить все без изменений.
Выполните все ячейки `main.ipynb`.

# Как это работает (часть для вступительного задания)
Основной моделью была выбрана претренированная на ImageNet Resnet18, т.к. датасет небольшой и содержит всего 9 классов.
Разделение на тренировочный, проверочный и тестовый датасеты было решено сделать так: 60%, 20%, 20%. А batch size равным 64.

После анализа датасета, выяснилось, что среднее значение и стандартное отклонение примерно (0.4815, 0.4523, 0.4579) и (0.2643, 0.2634, 0.2638) соответственно. Эти значения и будем использовать для нормализации картинок.

Постольку поскольку датасет содержит картинки с разных ракурсов, не будем утруждать себя лишними трансформациями, а просто изменим размер картинки на привычный Resnet18 224x224.

Уже после 32 эпох (что заняло около 10 минут ожидания на RTX 2050 mobile) минимальная потеря проверки (validation loss) составила ~0.283, а точность на тестовом датасете ~99%. Можно сделать вывод, что тренировка занимает не так много времени даже на ноутбуке с видеокартой средне-нижнего уровня.

Взаимодействовать с моделью можно через консольный скрипт, написанный с использованием `setuptools` и `argparse`.

# Видео с тестированием
[Файл с видео](test.mkv)
